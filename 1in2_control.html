<div class="glass p-8 rounded-[2rem] border border-red-900/30 text-center bg-black">
    <h3 class="orbitron text-red-500 text-[10px] font-black uppercase tracking-[0.4em] mb-4">Internal Command</h3>
    
    <button id="purge-btn" onclick="triggerInternalReset()" 
        class="w-full py-6 bg-red-600 hover:bg-white hover:text-black text-white rounded-2xl font-black uppercase italic tracking-tighter shadow-lg shadow-red-900/40 transition-all active:scale-95 group border border-red-500/50">
        Execute Nuclear Reset
    </button>
    
    <p id="purge-status" class="text-[9px] text-zinc-500 mt-4 font-bold uppercase tracking-widest">Protocol: RPC-Override</p>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
    const SB_URL = 'https://tbvmgcknkwsucstedigd.supabase.co';
    const SB_ANON_KEY = 'YOUR_PUBLIC_ANON_KEY'; // Use your standard public key here

    const sb = window.supabase.createClient(SB_URL, SB_ANON_KEY);

    async function triggerInternalReset() {
        const btn = document.getElementById('purge-btn');
        const status = document.getElementById('purge-status');

        if (!confirm("FORCE INTERNAL RESET?")) return;

        btn.disabled = true;
        status.innerText = "SIGNALING DATABASE...";

        try {
            // This calls the SQL function we created in Step 1
            const { error } = await sb.rpc('nuclear_reset_1in2');

            if (error) throw error;

            status.innerText = "ARENA PURGED SUCCESSFULLY";
            status.className = "text-[9px] text-green-500 font-black";
            btn.className = "w-full py-6 bg-green-600 text-white rounded-2xl font-black uppercase italic";
            
            setTimeout(() => location.reload(), 2000);

        } catch (err) {
            console.error(err);
            status.innerText = "FAILURE: " + err.message;
            status.className = "text-[9px] text-red-600 font-black";
            btn.disabled = false;
        }
    }
</script>
