<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="bg-orange-50 p-6">
    <div class="max-w-md mx-auto bg-white p-6 rounded-xl shadow">
        <h1 class="text-2xl font-bold mb-4">CHICKEN LEAGUE SIGNUP</h1>
        <input type="text" id="u" placeholder="Username" class="w-full mb-2 p-3 border">
        <input type="tel" id="ph" placeholder="Phone" class="w-full mb-2 p-3 border">
        <input type="password" id="ps" placeholder="Password" class="w-full mb-4 p-3 border">
        
        <button id="runBtn" onclick="doSignup()" class="w-full bg-orange-600 text-white p-4 font-bold rounded">
            CREATE ACCOUNT & PLAY
        </button>
    </div>

    <script>
        const _URL = 'https://tbvmgcknkwsucstedigd.supabase.co';
        const _KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRidm1nY2tua3dzdWNzdGVkaWdkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc5ODgwMjQsImV4cCI6MjA4MzU2NDAyNH0.OhfvqWaGLwNvIJq8TBDomdtKWDII5MvC6zhKKJBUD9Q';
        const sb = window.supabase.createClient(_URL, _KEY);

        async function doSignup() {
            alert("Button Clicked!"); // If you don't see this, your code didn't update on Vercel
            const u = document.getElementById('u').value;
            const ph = document.getElementById('ph').value;
            const ps = document.getElementById('ps').value;

            const { error } = await sb.from('Profiles').insert([{ 
                public_username: u, 
                phone_number: ph, 
                password: ps, 
                total_score: 0 
            }]);

            if (error) {
                alert("Database Error: " + error.message);
            } else {
                alert("SUCCESS! REDIRECTING...");
                localStorage.setItem('league_user', u);
                window.location.href = "dashboard.html";
            }
        }
    </script>
</body>
</html>
